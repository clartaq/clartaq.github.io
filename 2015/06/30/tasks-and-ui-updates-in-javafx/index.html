<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.79.1" />

  <title>Tasks and UI Updates in JavaFX &middot; Yo-Dave</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://yo-dave.com/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://yo-dave.com/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://yo-dave.com/css/blackburn.css">

  
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.9.0/css/all.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/clojure.min.js"></script>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/lisp.min.js"></script>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/dos.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://yo-dave.com/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  

  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://yo-dave.com/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://yo-dave.com/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://yo-dave.com/about/about"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://yo-dave.com/contact/contact"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href=""></a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/clartaq" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/193509" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2011-2020, David D. Clark. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Tasks and UI Updates in JavaFX</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>30 Jun 2015 12:00:00 AM</time>
  </div>

  

  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://yo-dave.com/tags/concurrency">concurrency</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://yo-dave.com/tags/java">java</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://yo-dave.com/tags/javafx">javafx</a>
    
  </div>
  
  

</div>

  <p>Recently, I answered a <a href="http://stackoverflow.com/questions/30980138/javafx-indeterminate-progress-bar-while-doing-a-process/30986188#30986188">question</a> on <a href="http://stackoverflow.com/">StackOverflow</a> related to executing a long-running task in the background of a JavaFX application while updating the UI on the progress of that task. I have found myself coming back to that solution several times now.</p>
<p>It wasn&rsquo;t a very good question by the <a href="http://stackoverflow.com/tour">standards of the forum</a>, with little research or explanation. In fact, it had been down-voted. But it piqued my interest because of a similar problem I had recently. In a program that I have been working on, at start up, there is a check for the presence of a database. If the database is not found, the program needs to write a &ldquo;seed&rdquo; version. I wanted this to happen before the main UI came up, but with a window showing progress on the task. I asked a <a href="http://stackoverflow.com/questions/30917285/javafx-splash-screen-message-and-progress-not-updating">similar question</a> on StackOverflow. (Things weren&rsquo;t working for me because of an embarrassing little bit of stupidity.)</p>
<p>An <a href="https://gist.github.com/jewelsea/2305098">example</a> by the amazing <a href="http://stackoverflow.com/users/1155209/jewelsea">JewelSea</a> provided the hint I needed. Since that time I have found myself using similar solutions for all kinds of problems.</p>
<p>Here&rsquo;s the answer I provided.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#f92672">package</span> Demo<span style="color:#f92672">;</span>

<span style="color:#f92672">import</span> javafx.application.Application<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> javafx.concurrent.Task<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> javafx.concurrent.WorkerStateEvent<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> javafx.event.ActionEvent<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> javafx.event.EventHandler<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> javafx.geometry.Insets<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> javafx.scene.Scene<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> javafx.scene.control.Button<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> javafx.scene.control.Label<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> javafx.scene.control.ProgressBar<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> javafx.scene.layout.VBox<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> javafx.stage.Stage<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> javafx.stage.StageStyle<span style="color:#f92672">;</span>

<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">BackgroundWorkerDemo</span> <span style="color:#66d9ef">extends</span> Application <span style="color:#f92672">{</span>

    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">static</span> String CNTR_LBL_STR <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Counter: &#34;</span><span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> counter<span style="color:#f92672">;</span>

    Label counterLabel<span style="color:#f92672">;</span>
    Button counterButton<span style="color:#f92672">;</span>
    Button taskButton<span style="color:#f92672">;</span>

    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">start</span><span style="color:#f92672">(</span>Stage primaryStage<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        counter <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span>
        counterLabel <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Label<span style="color:#f92672">(</span>CNTR_LBL_STR <span style="color:#f92672">+</span> counter<span style="color:#f92672">);</span>
        counterButton <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Button<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Increment Counter&#34;</span><span style="color:#f92672">);</span>
        counterButton<span style="color:#f92672">.</span><span style="color:#a6e22e">setOnAction</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> EventHandler<span style="color:#f92672">&lt;</span>ActionEvent<span style="color:#f92672">&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">handle</span><span style="color:#f92672">(</span>ActionEvent e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                counter<span style="color:#f92672">++;</span>
                counterLabel<span style="color:#f92672">.</span><span style="color:#a6e22e">setText</span><span style="color:#f92672">(</span>CNTR_LBL_STR <span style="color:#f92672">+</span> counter<span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">});</span>
        taskButton <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Button<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Long Running Task&#34;</span><span style="color:#f92672">);</span>
        taskButton<span style="color:#f92672">.</span><span style="color:#a6e22e">setOnAction</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> EventHandler<span style="color:#f92672">&lt;</span>ActionEvent<span style="color:#f92672">&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">handle</span><span style="color:#f92672">(</span>ActionEvent e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
               runTask<span style="color:#f92672">();</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">});</span>

        VBox mainPane <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> VBox<span style="color:#f92672">();</span>
        mainPane<span style="color:#f92672">.</span><span style="color:#a6e22e">setPadding</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Insets<span style="color:#f92672">(</span>10<span style="color:#f92672">));</span>
        mainPane<span style="color:#f92672">.</span><span style="color:#a6e22e">setSpacing</span><span style="color:#f92672">(</span>5<span style="color:#f92672">.</span><span style="color:#a6e22e">0d</span><span style="color:#f92672">);</span>
        mainPane<span style="color:#f92672">.</span><span style="color:#a6e22e">getChildren</span><span style="color:#f92672">().</span><span style="color:#a6e22e">addAll</span><span style="color:#f92672">(</span>counterLabel<span style="color:#f92672">,</span> counterButton<span style="color:#f92672">,</span> taskButton<span style="color:#f92672">);</span>
        primaryStage<span style="color:#f92672">.</span><span style="color:#a6e22e">setScene</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Scene<span style="color:#f92672">(</span>mainPane<span style="color:#f92672">));</span>
        primaryStage<span style="color:#f92672">.</span><span style="color:#a6e22e">show</span><span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">runTask</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>

        <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">double</span> wndwWidth <span style="color:#f92672">=</span> 300<span style="color:#f92672">.</span><span style="color:#a6e22e">0d</span><span style="color:#f92672">;</span>
        Label updateLabel <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Label<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Running tasks...&#34;</span><span style="color:#f92672">);</span>
        updateLabel<span style="color:#f92672">.</span><span style="color:#a6e22e">setPrefWidth</span><span style="color:#f92672">(</span>wndwWidth<span style="color:#f92672">);</span>
        ProgressBar progress <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ProgressBar<span style="color:#f92672">();</span>
        progress<span style="color:#f92672">.</span><span style="color:#a6e22e">setPrefWidth</span><span style="color:#f92672">(</span>wndwWidth<span style="color:#f92672">);</span>

        VBox updatePane <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> VBox<span style="color:#f92672">();</span>
        updatePane<span style="color:#f92672">.</span><span style="color:#a6e22e">setPadding</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Insets<span style="color:#f92672">(</span>10<span style="color:#f92672">));</span>
        updatePane<span style="color:#f92672">.</span><span style="color:#a6e22e">setSpacing</span><span style="color:#f92672">(</span>5<span style="color:#f92672">.</span><span style="color:#a6e22e">0d</span><span style="color:#f92672">);</span>
        updatePane<span style="color:#f92672">.</span><span style="color:#a6e22e">getChildren</span><span style="color:#f92672">().</span><span style="color:#a6e22e">addAll</span><span style="color:#f92672">(</span>updateLabel<span style="color:#f92672">,</span> progress<span style="color:#f92672">);</span>

        Stage taskUpdateStage <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Stage<span style="color:#f92672">(</span>StageStyle<span style="color:#f92672">.</span><span style="color:#a6e22e">UTILITY</span><span style="color:#f92672">);</span>
        taskUpdateStage<span style="color:#f92672">.</span><span style="color:#a6e22e">setScene</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Scene<span style="color:#f92672">(</span>updatePane<span style="color:#f92672">));</span>
        taskUpdateStage<span style="color:#f92672">.</span><span style="color:#a6e22e">show</span><span style="color:#f92672">();</span>

        Task longTask <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Task<span style="color:#f92672">&lt;</span>Void<span style="color:#f92672">&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">protected</span> Void <span style="color:#a6e22e">call</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">int</span> max <span style="color:#f92672">=</span> 50<span style="color:#f92672">;</span>
                <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 1<span style="color:#f92672">;</span> i <span style="color:#f92672">&lt;=</span> max<span style="color:#f92672">;</span> i<span style="color:#f92672">++)</span> <span style="color:#f92672">{</span>
                    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>isCancelled<span style="color:#f92672">())</span> <span style="color:#f92672">{</span>
                        <span style="color:#66d9ef">break</span><span style="color:#f92672">;</span>
                    <span style="color:#f92672">}</span>
                    updateProgress<span style="color:#f92672">(</span>i<span style="color:#f92672">,</span> max<span style="color:#f92672">);</span>
                    updateMessage<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Task part &#34;</span> <span style="color:#f92672">+</span> String<span style="color:#f92672">.</span><span style="color:#a6e22e">valueOf</span><span style="color:#f92672">(</span>i<span style="color:#f92672">)</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; complete&#34;</span><span style="color:#f92672">);</span>

                    Thread<span style="color:#f92672">.</span><span style="color:#a6e22e">sleep</span><span style="color:#f92672">(</span>100<span style="color:#f92672">);</span>
                <span style="color:#f92672">}</span>
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">};</span>

        longTask<span style="color:#f92672">.</span><span style="color:#a6e22e">setOnSucceeded</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> EventHandler<span style="color:#f92672">&lt;</span>WorkerStateEvent<span style="color:#f92672">&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">handle</span><span style="color:#f92672">(</span>WorkerStateEvent t<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                taskUpdateStage<span style="color:#f92672">.</span><span style="color:#a6e22e">hide</span><span style="color:#f92672">();</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">});</span>
        progress<span style="color:#f92672">.</span><span style="color:#a6e22e">progressProperty</span><span style="color:#f92672">().</span><span style="color:#a6e22e">bind</span><span style="color:#f92672">(</span>longTask<span style="color:#f92672">.</span><span style="color:#a6e22e">progressProperty</span><span style="color:#f92672">());</span>
        updateLabel<span style="color:#f92672">.</span><span style="color:#a6e22e">textProperty</span><span style="color:#f92672">().</span><span style="color:#a6e22e">bind</span><span style="color:#f92672">(</span>longTask<span style="color:#f92672">.</span><span style="color:#a6e22e">messageProperty</span><span style="color:#f92672">());</span>

        taskUpdateStage<span style="color:#f92672">.</span><span style="color:#a6e22e">show</span><span style="color:#f92672">();</span>
        <span style="color:#66d9ef">new</span> Thread<span style="color:#f92672">(</span>longTask<span style="color:#f92672">).</span><span style="color:#a6e22e">start</span><span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        launch<span style="color:#f92672">(</span>args<span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>

<span style="color:#f92672">}</span>
</code></pre></div><p>The program puts up a little window with a counter, a button to increment the counter, and a button to start a long-running background task. Once the background task is started, another window is displayed that shows the progress of the task. The window is hidden when the task is completed.</p>
<p>While the task is running, the user can increment the counter any number of times by pressing the button. The user also can start multiple versions of the long-running task. All-in-all, a very general solution.</p>
  
  

  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://yo-dave.com/2015/05/28/web-vs.-native-app-redux/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://yo-dave.com/2015/05/28/web-vs.-native-app-redux/">Web vs. Native App Redux</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://yo-dave.com/2015/07/27/finding-mono-spaced-fonts-in-javafx/">Finding Mono-Spaced Fonts in JavaFX</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://yo-dave.com/2015/07/27/finding-mono-spaced-fonts-in-javafx/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>



  

</div>

</div>
</div>
<script src="https://yo-dave.com/js/ui.js"></script>
<script src="https://yo-dave.com/js/menus.js"></script>








</body>
</html>

